---
import { Languages } from "lucide-astro";
import { useTranslations } from "../i18n/utils";
import {
  getCurrentLocale,
  getLocaleSwitchUrl,
  getRelativeLocaleUrl,
} from "../i18n/logicNav";

const currentLang = getCurrentLocale(Astro.currentLocale);
const translateUi = useTranslations(currentLang);
const { url: switchTo, label } = await getLocaleSwitchUrl(
  currentLang,
  Astro.url.pathname,
);

const homeHref = getRelativeLocaleUrl(currentLang, "/");
const blogHref = getRelativeLocaleUrl(currentLang, "/blog");
---

<header class="sticky top-4 z-50 w-full px-4" aria-label="Main navigation">
  <nav
    class="nav-container
    [animation-timeline:scroll()]
    [animation-range:0_80px]
    [animation-fill-mode:both]
    [animation-name:stickynav]"
  >
    <a
      href={homeHref}
      class="group flex items-center gap-2 opacity-90 hover:opacity-100 transition-opacity"
    >
      <div class="relative overflow-hidden rounded-full">
        <img
          src="/img/profile.webp"
          alt="Arcibyte profile"
          loading="lazy"
          class="w-8 h-8 object-cover transition-transform duration-300 group-hover:scale-110"
        />
      </div>
      <span
        class="text-sm font-semibold tracking-tight text-foreground hover:text-primary"
      >
        Arcibyte
      </span>
    </a>

    <div class="flex items-center gap-2">
      <a
        href={blogHref}
        class="text-sm font-medium text-foreground hover:text-primary transition-colors duration-200"
      >
        {translateUi("nav.blog")}
      </a>

      <div class="h-4 w-[1px] bg-border hidden sm:block"></div>

      <a
        href={switchTo}
        class="flex items-center gap-1.5 px-3 py-1.5 rounded-full
        text-foreground hover:text-primary hover:bg-muted/50
        transition-all duration-200"
        aria-label={`Switch to ${label}`}
      >
        <Languages class="w-3.5 h-3.5" />
        <span class="text-xs font-medium">{label}</span>
      </a>
    </div>
  </nav>
</header>
